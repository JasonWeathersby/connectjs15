<html>

<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <link href="styles/style.css" rel="stylesheet" />
</head>

<body>
    <div id="container">
        <h1>Sync Restyle</h1>
        <ul class="pipeline">
            <li class="js active">JavaScript</li>
            <li class="restyle active">Restyle</li>
            <li class="reflow">Reflow</li>
            <li class="paint active">Paint</li>
            <li class="composite active">Composite</li>
        </ul>
        <p class="description">
            When setting a style and immediately fetching the value, the browser is forced to compute the resulting style immediately to return the value synchronously when requested in JS. If you need to access computed style values after setting them, atleast batch up the style reads after the style writes.
        </p>
        <button id="mybutton" onclick="go();">Force Sync Restyle</button>
        <div id="block" class="mybox"></div>
    </div>
    <script>
        var block = document.querySelector("#block");

        function go() {
            var _;
            block.style.backgroundColor = "blue";
            //Reading the properties of the style after setting will cause a synch restyle
            _ = window.getComputedStyle(mybutton, "").backgroundColor;
            block.style.backgroundColor = "green";
            _ = window.getComputedStyle(block, "").backgroundImage;
            block.style.backgroundColor = "red";
            _ = window.getComputedStyle(block, "").backgroundAttachment;
            block.style.backgroundColor = "orange";
            _ = window.getComputedStyle(block, "").color;
        }
    </script>
</body>

</html>